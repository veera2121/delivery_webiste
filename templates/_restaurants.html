<div class="restaurant-row">
{% for r in restaurants %}

    {# ================= FORCE OPEN ================= #} 
    {% set is_open = True %}
    {% set can_accept = True %}
    {% set is_suspended = False %}
    {% set is_coming_soon = False %}

    <div class="card"
         onclick="window.location.href='/menu/{{ r.id }}'"
    >

        {# ================= IMAGE ================= #}
        <img 
            src="/static/images/restaurants/{{ r.id }}.jpg"
            alt="{{ r.name }}"
            onerror="this.onerror=null; this.src='/static/images/restaurants/img1.jpg';"
        >

        {# ================= CONTENT ================= #}
        <div class="content">

            <div class="restaurant-name">{{ r.name }}</div>

            {% if r.is_veg %}
                <div class="veg-badge">Veg</div>
            {% else %}
                <div class="nonveg-badge">Non-Veg</div>
            {% endif %}

            <div class="details">
                <div class="rating">{{ r.rating }} â­</div>
                <div class="price">{{ r.price_level }}</div>
                <div class="time">{{ r.delivery_time }}</div>
            </div>

            <div class="popular">ğŸ½ï¸ {{ r.popular_items }}</div>

            {% if r.free_delivery_limit > 0 %}
                <div class="free-delivery">
                    ğŸšš Free Delivery on â‚¹{{ r.free_delivery_limit }}+
                </div>
            {% else %}
                <div class="delivery-charge">
                    ğŸšš Delivery â‚¹{{ r.delivery_charge }}
                </div>
            {% endif %}
            
            <div class="open-close">
                ğŸ•’
                {% if r.opening_time and r.closing_time %}
                    {{ r.opening_time.strftime("%I:%M %p") }}
                    â€“
                    {{ r.closing_time.strftime("%I:%M %p") }}
                {% else %}
                    Timing not available
                {% endif %}
            </div>

            {# ================= ACTION BUTTON ================= #}
            <a href="/menu/{{ r.id }}" class="view-btn">View Menu</a>

        </div>   <!-- âœ… CLOSE .content -->
    </div>       <!-- âœ… CLOSE .card -->

{% endfor %}
</div>           <!-- âœ… CLOSE .restaurant-row -->

{% if trending_items|length > 0 %}
<section class="trending-section">
    <h2>ğŸ”¥ Trending in {{ selected_location }}</h2>

    <div class="trending-grid">
        {% for item in trending_items %}
        <div class="food-card">
            <span class="badge">ğŸ”¥ Trending</span>
            <h4>{{ item.name }}</h4>
            <p>â‚¹{{ item.price }}</p>
            <small>
                From {{ item.restaurant.name if item.restaurant else "Unknown" }}
            </small>
        </div>
        {% endfor %}
    </div>
</section>
{% endif %}
