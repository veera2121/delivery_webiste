{% extends "base.html" %}

{% block title %}Manage Offers{% endblock %}

{% block content %}
<div class="dashboard-page">
  <h2>Manage Restaurant Offers</h2>

  <a href="{{ url_for('add_offer', restaurant_id=restaurant.id) }}" class="btn btn-primary mb-3">Add New Offer</a>

    <thead>
      <tr>
        <th>Title</th>
        <th>Type</th>
        <th>Value</th>
        <th>Min Order</th>
        <th>Start Date</th>
        <th>End Date</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for offer in offers %}
      <tr>
        <td>{{ offer.title }}</td>
        <td>{{ offer.offer_type.replace("_", " ")|title }}</td>
        <td>
          {% if offer.offer_type != 'free_delivery' %}
            {{ offer.offer_value }}
            {% if offer.offer_type == 'percent' %}%{% endif %}
          {% else %}
            -
          {% endif %}
        </td>
        <td>{{ offer.min_order_amount or 0 }}</td>
        <td>{{ offer.start_date.strftime("%d %b %Y") if offer.start_date else "Not set" }}</td>
        <td>{{ offer.end_date.strftime("%d %b %Y") if offer.end_date else "Not set" }}</td>
        <td>
          {% if not offer.is_active %}
            <span class="badge badge-gray">Inactive</span>
          {% elif offer.start_date and now < offer.start_date %}
            <span class="badge badge-blue">Upcoming</span>
          {% elif offer.end_date and now > offer.end_date %}
            <span class="badge badge-red">Expired</span>
          {% else %}
            <span class="badge badge-green">Active</span>
          {% endif %}
        </td>
        <td>
          <a href="{{ url_for('edit_offer', offer_id=offer.id) }}" class="btn btn-sm btn-primary">Edit</a>
          <a href="{{ url_for('delete_offer', offer_id=offer.id) }}" class="btn btn-sm btn-danger" onclick="return confirm('Are you sure you want to delete this offer?');">Delete</a>
        </td>
      </tr>
      {% else %}
      <tr>
        <td colspan="8" style="text-align:center;">No offers found.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<style>
.dashboard-page {
  max-width: 1000px;
  margin: 40px auto;
  padding: 20px;
  background: #fff;
  border-radius: 8px;
  box-shadow: 0 2px 6px rgba(0,0,0,.1);
}

.table {
  width: 100%;
  border-collapse: collapse;
}

.table th, .table td {
  padding: 10px;
  border: 1px solid #ddd;
  text-align: center;
}

.btn {
  padding: 5px 12px;
  border-radius: 4px;
  text-decoration: none;
}

.btn-primary { background: #007bff; color: #fff; }
.btn-danger { background: #dc3545; color: #fff; }
.btn-sm { font-size: 12px; padding: 4px 8px; }

.badge {
  padding: 4px 10px;
  border-radius: 12px;
  font-size: 12px;
  font-weight: 600;
}

.badge-green { background: #28a745; color: #fff; }
.badge-red   { background: #dc3545; color: #fff; }
.badge-blue  { background: #007bff; color: #fff; }
.badge-gray  { background: #6c757d; color: #fff; }
</style>
{% endblock %}
